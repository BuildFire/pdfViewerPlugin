<!DOCTYPE html>
<html ng-app="webviewPlugin">
<head lang="en">
    <meta charset="UTF-8">
    <script type="text/javascript" src="../../../scripts/buildfire.js"></script>
</head>
<body>
<div style="text-align: center;vertical-align: middle; height: 100%">
    <h2 style="margin-top: 50%; opacity: .25;">.pdf</h2>
</div>
<script>
        buildfire.spinner.show();

        function dataLoadedHandler(result) {

            if (result && result.data) {
                var content = result.data.content;
                if (content && content.url) {
                    buildfire.getContext(function (err, context) {
                        if (context.device.platform == "web")
                            buildfire.navigation.openWindow(content.url, "_blank");
                        else {
                            if (content.openInApp) {
                                if(context.device.platform.toLowerCase() == "android")
                                    buildfire.navigation.openWindow("https://docs.google.com/viewer?url=" + encodeURIComponent(content.url) , "_blank");
                                else
                                    buildfire.navigation.openWindow(content.url , "_blank");
                            }
                            else
                                buildfire.navigation.openWindow(content.url, "_system");
                            
                            buildfire.navigation.goBack();
                        }
                        
                        buildfire.spinner.hide();
                    });
                }
            }
        }

        /**
         * Go pull saved data
         * */
        buildfire.datastore.get(function (err, result) {
            if (err) {
                console.error("Error: ", err);
                buildfire.spinner.hide();
            } else {
                dataLoadedHandler(result);
            }
        });

        /**
         * when a refresh is triggered get reload data
         */
        buildfire.datastore.onRefresh(loadData);

        buildfire.datastore.onUpdate(function (result) {
            dataLoadedHandler(result);
        });
   
</script>
</body>
</html>
